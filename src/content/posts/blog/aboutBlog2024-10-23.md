---
title: å…³äºåšå®¢æœ€è¿‘çš„æ”¹åŠ¨å’Œå˜åŒ–(2024-10-23)
published: 2024-10-23
description: è¿™ç¯‡åšå®¢ä¸»è¦è®°å½•äº†åšå®¢æœ€è¿‘çš„ä¸€äº›æ”¹åŠ¨å’Œå˜åŒ–ã€‚åŒ…æ‹¬æœ€è¿‘çš„ç½‘ç«™ç»Ÿè®¡ï¼Œä»¥åŠä¸€äº›é¢å¤–æ·»åŠ çš„åŠŸèƒ½ã€‚æŸ¥çœ‹commitè®°å½•ä¹Ÿokï¼Œä¸è¿‡ä¸ªäººåšå®¢æ¨çš„æŒºéšæ„çš„ï¼Œcommitç¡®å®æœ‰ç‚¹æŠ½è±¡ã€‚è€Œä¸”æœ‰å¾ˆå¤šåªæ˜¯å¤šä¸€è¡Œç©ºè¡Œæˆ–å°‘ä¸€è¡Œçš„ä¹Ÿç»™æˆ‘ä¼ ä¸Šå»äº†ğŸ¤“ã€‚

tags: [Blog]
category: Blog
draft: false
---

è¿™ç¯‡åšå®¢ä¸»è¦è®°å½•äº†åšå®¢æœ€è¿‘çš„ä¸€äº›æ”¹åŠ¨å’Œå˜åŒ–ã€‚åŒ…æ‹¬æœ€è¿‘çš„ç½‘ç«™ç»Ÿè®¡ï¼Œä»¥åŠä¸€äº›é¢å¤–æ·»åŠ çš„åŠŸèƒ½ã€‚
æŸ¥çœ‹commitè®°å½•ä¹Ÿokï¼Œä¸è¿‡ä¸ªäººåšå®¢æ¨çš„æŒºéšæ„çš„ï¼Œcommitç¡®å®æœ‰ç‚¹æŠ½è±¡ã€‚è€Œä¸”æœ‰å¾ˆå¤šåªæ˜¯å¤šä¸€è¡Œç©ºè¡Œæˆ–å°‘ä¸€è¡Œçš„ä¹Ÿç»™æˆ‘ä¼ ä¸Šå»äº†ğŸ¤“ã€‚

<!--more-->

## å…³äºç½‘ç«™ç»Ÿè®¡

ä¹‹å‰ä¸€ç›´ä½¿ç”¨çš„æ˜¯`51la`æä¾›çš„ç½‘ç«™ç»Ÿè®¡æœåŠ¡ã€‚ä½†æ˜¯ç”±äº`51la`ç»å¸¸è¢«ddosï¼Œå¯¼è‡´ç½‘ç«™ç»Ÿè®¡ä¿¡æ¯è€æ˜¯æ˜¾ç¤ºä¸å‡ºæ¥ï¼Œè€Œä¸”
æˆ‘ä¹Ÿç»å¸¸ä¸Šä¸å»ä»–ä»¬å®˜ç½‘ã€‚æ‰€ä»¥æ¢æˆäº†`busuanzi`(ç”±äºä¸Šä¸å»`51la`ï¼Œå¯¼è‡´ä¹‹å‰çš„æ•°æ®ä¹Ÿæ‹¿ä¸åˆ°äº†)ã€‚

### busuanzi

[busuanzi](https://busuanzi.apifox.cn/) æä¾›äº†å…è´¹ä¸”æ˜“äºä½¿ç”¨çš„ç½‘ç«™ç»Ÿè®¡æœåŠ¡ã€‚ä½¿ç”¨åˆ° API `https://busuanzi.9420.ltd/js ` ã€‚

ä¹‹åå¯èƒ½éœ€è¦æŸ¥æ‰¾ä¸€ä¸‹`id`ï¼Œåˆ å»äº†åŸæ¥çš„`busuanzi_value_site_pv`å’Œ`busuanzi_value_site_uv`ç­‰çš„`value`ã€‚

### ä¸»è¦ä¿®æ”¹æ–‡ä»¶


- `data/resources.yaml`
- `layouts/partials/sidebar/siteinfo.html`
- `layouts/partials/post/header_meta/views.html`
- `layouts/partials/post/header_meta/visitors.html`
- `assets/js/utils.js`

## å…³äºé¢å¤–åŠŸèƒ½

### Asoul å°äºº

è¿™è¾¹å¯ä»¥å‚è€ƒgithubåšå®¢ä»“åº“`README.md`ã€‚æˆ‘forkäº†[stevenjoezhang/live2d-widget](https://github.com/stevenjoezhang/live2d-widget)çš„ä»“åº“ï¼Œå¹¶å¢åŠ äº†modelsã€‚

+ [ ] [å¦‚ä½•å°†å˜‰ç„¶live2Dæ·»åŠ åˆ°åšå®¢ç½‘ç«™å½“çœ‹æ¿å¨˜](https://www.moeshou.com/310/) 
  + æ·»åŠ äº†å˜‰ç„¶Dianaçš„live2dæ¨¡å‹ï¼Œåœ¨`layouts/post/footer.html`ä¸­ã€‚
+ [ ] å˜‰ç„¶Diana moc3æ¨¡å‹æ¥æºäº[https://www.bilibili.com/video/BV1FZ4y1F7HH](https://www.bilibili.com/video/BV1FZ4y1F7HH)
+ [ ] å‘æ™šAva moc3æ¨¡å‹æ¥æºäº[https://www.bilibili.com/video/BV1uB4y1w7H](https://www.bilibili.com/video/BV1uB4y1w7H)
+ [ ] models:
  + [https://github.com/xiaoski/live2d_models_collection](https://github.com/xiaoski/live2d_models_collection)
  + [https://www.jsdelivr.com/package/gh/journey-ad/blog-img?tab=files&path=live2d](https://www.jsdelivr.com/package/gh/journey-ad/blog-img?tab=files&path=live2d)

### å¯¼å…¥Bç«™è§†é¢‘

å‚è€ƒåšå®¢æ¥æº [Zoe's Dumpster è®°å½•MemEä¸»é¢˜ç¾åŒ–è¿‡ç¨‹](https://blog.tantalum.life/posts/meme-theme-modify/)ã€‚
æˆ‘ç›´æ¥åœ¨`layouts/shortcodes/bilibili.html`ä¸­æ·»åŠ äº†`\{\{< bilibili BVxxxxx>}}`çš„shortcodeã€‚
åœ¨åšå®¢ä¸­é€šè¿‡`\{\{< bilibili BVxxxxx>}}`(ä¸éœ€è¦åŠ '\\',è¿™é‡Œæ˜¯ä¸ºäº†é˜²æ­¢æ’å…¥è§†é¢‘)å°±å¯ä»¥æ’å…¥Bç«™è§†é¢‘äº†ã€‚

```html
{{ $videoID := index .Params 0 }}
{{ $pageNum := index .Params 1 | default 1}}

{{ if (findRE "^[bB][vV][0-9a-zA-Z]+$" $videoID) }}
<div><iframe id="biliplayer" src="//player.bilibili.com/player.html?bvid={{ $videoID }}&page={{ $pageNum }}" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" loading="lazy" > </iframe></div>
{{ else }}
<div><iframe id="biliplayer" src="//player.bilibili.com/player.html?aid={{ $videoID }}&page={{ $pageNum }}" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" loading="lazy" > </iframe></div>
{{ end }}

<style>
// åµŒå…¥ BiliBili è§†é¢‘
#biliplayer {
  width: 100%;
  height: 550px;
}
@media only screen and (min-device-width: 320px) and (max-device-width: 480px) {
  #biliplayer {
    width: 100%;
    height: 250px;
  }
}
</style>
```

### é¼ æ ‡ç‚¹å‡»ç‰¹æ•ˆ

è¿™é‡Œæ˜¯ç½‘ä¸Šæ‰¾çš„é¼ æ ‡ç‚¹å‡»ç‰¹æ•ˆï¼Œæ·»åŠ åˆ°äº†`layouts/partials/scripts.html`ä¸­ã€‚

```html
<script>
(function () {
  let balls = [];
  let longPressed = false;
  let longPress;
  let multiplier = 0;
  let width, height;
  let origin;
  let normal;
  let ctx;
  const colours = ["#F73859", "#14FFEC", "#00E0FF", "#FF99FE", "#FAF15D"];
  const canvas = document.createElement("canvas");
  document.body.appendChild(canvas);
  canvas.setAttribute("style", "width: 60%; height: 60%; top: 0; left: 0; z-index: 99999; position: fixed; pointer-events: none;");
  const pointer = document.createElement("span");
  pointer.classList.add("pointer");
  document.body.appendChild(pointer);
 
  if (canvas.getContext && window.addEventListener) {
    ctx = canvas.getContext("2d");
    updateSize();
    window.addEventListener('resize', updateSize, false);
    loop();
    window.addEventListener("mousedown", function(e) {
      pushBalls(randBetween(10, 20), e.clientX, e.clientY);
      document.body.classList.add("is-pressed");
      longPress = setTimeout(function(){
        document.body.classList.add("is-longpress");
        longPressed = true;
      }, 500);
    }, false);
    window.addEventListener("mouseup", function(e) {
      clearInterval(longPress);
      if (longPressed == true) {
        document.body.classList.remove("is-longpress");
        pushBalls(randBetween(50 + Math.ceil(multiplier), 100 + Math.ceil(multiplier)), e.clientX, e.clientY);
        longPressed = false;
      }
      document.body.classList.remove("is-pressed");
    }, false);
    window.addEventListener("mousemove", function(e) {
      let x = e.clientX;
      let y = e.clientY;
      pointer.style.top = y + "px";
      pointer.style.left = x + "px";
    }, false);
  } else {
    console.log("canvas or addEventListener is unsupported!");
  }
 
 
  function updateSize() {
    canvas.width = window.innerWidth * 2;
    canvas.height = window.innerHeight * 2;
    canvas.style.width = window.innerWidth + 'px';
    canvas.style.height = window.innerHeight + 'px';
    ctx.scale(2, 2);
    width = (canvas.width = window.innerWidth);
    height = (canvas.height = window.innerHeight);
    origin = {
      x: width / 2,
      y: height / 2
    };
    normal = {
      x: width / 2,
      y: height / 2
    };
  }
  class Ball {
    constructor(x = origin.x, y = origin.y) {
      this.x = x;
      this.y = y;
      this.angle = Math.PI * 2 * Math.random();
      if (longPressed == true) {
        this.multiplier = randBetween(14 + multiplier, 15 + multiplier);
      } else {
        this.multiplier = randBetween(6, 12);
      }
      this.vx = (this.multiplier + Math.random() * 0.5) * Math.cos(this.angle);
      this.vy = (this.multiplier + Math.random() * 0.5) * Math.sin(this.angle);
      this.r = randBetween(8, 12) + 3 * Math.random();
      this.color = colours[Math.floor(Math.random() * colours.length)];
    }
    update() {
      this.x += this.vx - normal.x;
      this.y += this.vy - normal.y;
      normal.x = -2 / window.innerWidth * Math.sin(this.angle);
      normal.y = -2 / window.innerHeight * Math.cos(this.angle);
      this.r -= 0.3;
      this.vx *= 0.9;
      this.vy *= 0.9;
    }
  }
 
  function pushBalls(count = 1, x = origin.x, y = origin.y) {
    for (let i = 0; i < count; i++) {
      balls.push(new Ball(x, y));
    }
  }
 
  function randBetween(min, max) {
    return Math.floor(Math.random() * max) + min;
  }
 
  function loop() {
    ctx.fillStyle = "rgba(255, 255, 255, 0)";
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    for (let i = 0; i < balls.length; i++) {
      let b = balls[i];
      if (b.r < 0) continue;
      ctx.fillStyle = b.color;
      ctx.beginPath();
      ctx.arc(b.x, b.y, b.r, 0, Math.PI * 2, false);
      ctx.fill();
      b.update();
    }
    if (longPressed == true) {
      multiplier += 0.2;
    } else if (!longPressed && multiplier >= 0) {
      multiplier -= 0.4;
    }
    removeBall();
    requestAnimationFrame(loop);
  }
 
  function removeBall() {
    for (let i = 0; i < balls.length; i++) {
      let b = balls[i];
      if (b.x + b.r < 0 || b.x - b.r > width || b.y + b.r < 0 || b.y - b.r > height || b.r < 0) {
        balls.splice(i, 1);
      }
    }
  }
})();

</script>
```

### ç½‘é¡µè››ç½‘æ•ˆæœ

ä¹Ÿæ˜¯ç½‘ä¸Šæ‰¾çš„ï¼Œä¸è¿‡æ‰¾åˆ°çš„è²Œä¼¼éƒ½æ˜¯è¢«æ··æ·†è¿‡çš„ã€‚è™½ç„¶è¿˜æ˜¯èƒ½çœ‹æ‡‚éƒ¨åˆ†åœ°æ–¹ maybeã€‚

æ·»åŠ `assets/js/net-animation.js`ï¼Œè¿™é‡ŒæŠŠ`id`å›ºå®šä¸º`c_n75`ã€‚ä¾¿äºä¹‹åè®¾ç½®æš—äº®è‰²ä¸»é¢˜åˆ‡æ¢ã€‚æœ€åçš„`window.runNetAnimation`å‡½æ•°å¯ä»¥ä¼ å…¥é¢œè‰²å‚æ•°(rgbå½¢å¼`"255,255,255"`ï¼Œ`"0,0,0"`ç­‰)ï¼Œæ¥åˆ‡æ¢é¢œè‰²ã€‚
å½“ç„¶ï¼Œä¸ºäº†èƒ½åˆ‡æ¢ä¸»é¢˜è‰²ï¼Œé¢å¤–åœ¨ä¸Šé¢æ·»åŠ äº†ç§»é™¤åŸæ¥å¯èƒ½å·²ç»å­˜åœ¨çš„`canvas`ä»£ç ã€‚

```js
const runNetAnimation = function (the_color) {
    if (document.getElementById("c_n75") !== null) {
        document.getElementById("c_n75").remove();
    }

    function n(n, e, t) {
        return n.getAttribute(e) || t;
    }

    function t() {
        var t = document.getElementsByTagName("script"),
            o = t.length,
            i = t[o - 1];

        return {
            l: o,
            z: n(i, "zIndex", 2),
            o: n(i, "opacity", 0.5),
            c: n(i, "color", the_color),
            n: n(i, "count", 120),
        };
    }

    function o() {
        (a = m.width =
            window.innerWidth ||
            document.documentElement.clientWidth ||
            document.body.clientWidth),
            (c = m.height =
                window.innerHeight ||
                document.documentElement.clientHeight ||
                document.body.clientHeight);
    }

    function i() {
        r.clearRect(0, 0, a, c);
        var n, e, t, o, m, l;
        s.forEach(function (i, x) {
            for (i.x += i.xa, i.y += i.ya, i.xa *= i.x > a || i.x < 0 ? -1 : 1, i.ya *= i.y > c || i.y < 0 ? -1 : 1, r.fillRect(i.x - .5, i.y - .5, 1, 1), e = x + 1; e < u.length; e++) n = u[e], null !== n.x && null !== n.y && (o = i.x - n.x, m = i.y - n.y, l = o * o + m * m, l < n.max && (n === y && l >= n.max / 2 && (i.x -= .03 * o, i.y -= .03 * m), t = (n.max - l) / n.max, r.beginPath(), r.lineWidth = t / 2, r.strokeStyle = "rgba(" + d.c + "," + (t + .2) + ")", r.moveTo(i.x, i.y), r.lineTo(n.x, n.y), r.stroke()))
        }), x(i)
    }

    var a,
        c,
        u,
        m = document.createElement("canvas"),
        d = t(),
        l = "c_n75",
        r = m.getContext("2d"),
        x =
            window.requestAnimationFrame ||
            function (n) {
                window.setTimeout(n, 1e3 / 45);
            },
        w = Math.random,
        y = { x: null, y: null, max: 2e4 };
    (m.id = l),
        (m.style.cssText =
            "position:fixed;top:0;left:0;z-index:" + d.z + ";opacity:" + d.o + ";pointer-events:none"),
        document.getElementsByTagName("body")[0].appendChild(m),
        o(),
        (window.onresize = o),
        (window.onmousemove = function (n) {
            (n = n || window.event), (y.x = n.clientX), (y.y = n.clientY);
        }),
        (window.onmouseout = function () {
            (y.x = null), (y.y = null);
        });
    for (var s = [], f = 0; d.n > f; f++) {
        var h = w() * a,
            g = w() * c,
            v = 2 * w() - 1,
            p = 2 * w() - 1;
        s.push({ x: h, y: g, xa: v, ya: p, max: 6e3 });
    }
    (u = s.concat([y])),
        setTimeout(function () {
            i();
        }, 100);
};

window.runNetAnimation = runNetAnimation;
```

åœ¨`layouts/_default/baseof.html`ä¸­æ·»åŠ å¯åŠ¨è„šæœ¬ï¼Œè®©ç½‘é¡µåŠ è½½æ—¶è‡ªåŠ¨å¯åŠ¨è››ç½‘æ•ˆæœï¼ŒåŒæ—¶æ ¹æ®ä¸»é¢˜é¢œè‰²åˆ‡æ¢è››ç½‘é¢œè‰²ã€‚

```html
<script>
  document.documentElement.getAttribute('data-theme') === 'dark' ?
    runNetAnimation("255,255,255") :
    runNetAnimation("0,0,0"); 
</script>
```

åœ¨`assets/js/utils.js`ä¸­`registerToolButtons`å‡½æ•°ä¸ºæŒ‰é’®æ·»åŠ è‡ªåŠ¨æ”¹å˜è››ç½‘é¢œè‰²çš„åŠŸèƒ½ã€‚

```js
// in assets/js/utils.js: registerToolButtons: line 58
buttons.querySelector('div#toggle-theme').addEventListener('click', () => {
      const cur_theme = document.documentElement.getAttribute('data-theme');
      window.theme.toggle(cur_theme === 'dark' ? 'light' : 'dark');
      window.runNetAnimation(cur_theme === 'dark' ? "0,0,0" : "255,255,255");
    });
```

## å…¶ä»–æ”¹åŠ¨

### å­—ä½“

åœ¨`assets/css/_variables/base.scss`ä¸­æ·»åŠ äº†`custom-fonts-for-all`å˜é‡ï¼Œæ¥è®¾ç½®æ‰€æœ‰å­—ä½“ï¼Œä»¥åŠä¿®æ”¹`get-font-family`å‡½æ•°æ¥ä½¿ç”¨è¿™ä¸ªå˜é‡ã€‚ä¸ºäº†æ–¹ä¾¿ï¼Œè¿™é‡ŒæŠŠ`font-family-base`è®¾ç½®ä¸º`$font-family-english, $font-family-chinese`ã€‚
æœ¬æ¥æ˜¯æ‰“ç®—ç›´æ¥ç”¨`font-family-base`ï¼Œä½†æ˜¯è€æ˜¯å‡ºç°å­—ä½“ä¸å¯¹çš„æƒ…å†µğŸ˜¿ã€‚

```scss
$font-family-chinese      : 'PingFang SC', 'Microsoft YaHei';
$font-family-english      : -apple-system, BlinkMacSystemFont, Lora;
$font-family-base         :  $font-family-english, $font-family-chinese;

$custom-fonts-for-all: (
  'title':  'Lora, "PingFang SC"',
  'headings': 'Lora, "PingFang SC"',
  'posts': '"PingFang SC"',
  'codes': 'jetbrains mono'
);

@function get-font-family($config) {
  $custom-family: map-get($custom-fonts-for-all, $config);
  @return if(type-of($custom-family) == string, unquote($custom-family), null);
}
```

### é¢œè‰²

è°ƒæ•´äº†éƒ¨åˆ†é¢œè‰²ï¼Œä¸»è¦æ˜¯`$text-color-dark`å’Œ`$text-color`ã€‚(å› ä¸ºä¹‹å‰çš„é¢œè‰²å¤ªæµ…ï¼Œå®¹æ˜“çœ‹ä¸æ¸…æ¥š)ã€‚
è¿™ä¹Ÿæ˜¯åœ¨`assets/css/_variables/base.scss`ä¸­ä¿®æ”¹ã€‚

```scss
$text-color                   : #12183A;
$text-color-dark              : #ffffff;
```